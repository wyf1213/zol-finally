"use strict";requirejs.config({baseUrl:"./js",urlArgs:"va="+(new Date).getTime(),paths:{jquery:["./lib/jquery-1.11.1.min"],"jquery.cookie":["./lib/jquery.cookie"],popt:["./lib/city/Popt"],cityjson:["./lib/city/cityJson"],cityset:["./lib/city/citySet"],shim:{popt:{deps:["jquery"]},cityjson:{deps:["jquery"]},cityset:{deps:["jquery"]}}}}),requirejs(["jquery","backtotop","showUname","cartNums","jquery.cookie","popt","cityjson","cityset"],function(_,a,e,g){_(function(){a.back(),e.show(),g.getNum(),_(".nav .category_header").on("mouseenter",function(){_(this).siblings("div").show()}),_(".category_body .category_item_hd").on("mouseenter",function(){_(this).addClass("hover").siblings("div").removeClass("hover");var i=_(this).index();_(".category_body .category_content").show(),_(".category_body .category_content li").eq(i).show().siblings("li").hide()}),_(".category_body").on("mouseleave",function(){_(this).hide(),_(".category_body .category_content").hide(),_(".category_body .category_item_hd").removeClass("hover")}),_(".category").on("mouseleave",function(){_(this).children(".category_body").hide()}),_(".d_main_area").on("mouseenter",function(){_(".big_pup").show(),_(".d_big_area").show();var e=_(".d_main_area").width()/_(".big_pup").width();_(document).on("mousemove",function(i){var o=i.clientX-_(".d_main_area").position().left-_(".d_focus_img").position().left-_(".big_pup").width()/2;o<=0&&(o=0),o>=_(".d_main_area").width()-_(".big_pup").width()&&(o=_(".d_main_area").width()-_(".big_pup").width());var a=i.clientY-_(".d_main_area").position().top-_(".big_pup").height()/2-15;a<=0&&(a=0),a>=_(".d_main_area").height()-_(".big_pup").height()&&(a=_(".d_main_area").height()-_(".big_pup").height()),_(".big_pup").css({left:o,top:a}),_(".d_big_bg img").css({left:-e*o,top:-e*a})})}),_(".d_main_area").on("mouseleave",function(){_(".big_pup").hide(),_(".d_big_area").hide()}),_(".d_focus_img").on("click",".d_small_area li",function(){console.log(111);var i=_(this).index();_(this).addClass("active").siblings("li").removeClass("active");var o=JSON.parse(_(".d_deal_wrap").attr("data-info"));return _(".d_main_area img").attr("src",o.middleImg[i]),_(".d_big_bg img").attr("src",o.bigImg[i]),!1}),_("#city").on("click",function(i){SelCity(this,i)}),_(".d_goodsinfo").on("click",".d_goodsinfo_details li",function(){return _(this).addClass("current").siblings("li").removeClass("current"),!1}),_("#d_goodsinfo_del").on("click",function(){var i=parseInt(_("#d_goodsinfo_num").val());return 1==i||_("#d_goodsinfo_num").val(i-1),!1}),_("#d_goodsinfo_add").on("click",function(){var i=parseInt(_("#d_goodsinfo_num").val());return _("#d_goodsinfo_num").val(i+1),!1}),_("#d_gmain_tabbar ul li").on("click",function(){var i=_(this).index();return i<=_("#d_gmain_tabbar ul li").length-2&&(_(this).addClass("current").siblings("li").removeClass("current"),_(".d_maincontainer>div").eq(i).addClass("active").siblings("div").removeClass("active")),!1});var o=_(".topbar").height()+90+_(".header").height()+_(".nav").height()+_(".d_main").height();_(window).scroll(function(){var i=_(this).scrollTop();o<i?(_("#d_gmain_tabbar").addClass("tabbar_fixed"),_("#d_gmain_tabbar .d_gmain_buybtn").show()):(_("#d_gmain_tabbar").removeClass("tabbar_fixed"),_("#d_gmain_tabbar .d_gmain_buybtn").hide())}),_(".zs-enter-message .close").on("click",function(){_(".zs-enter-message").hide()});var i=location.search.split("=")[1];_.ajax({url:"./../server/goodslist.php",dataType:"json",data:{gId:i}}).then(function(i){_(".d_deal_wrap").attr("data-info",JSON.stringify(i)),_(".d_main_area img").attr("src",i.middleImg[0]),_(".d_big_area img").attr("src",i.bigImg[0]),i.smallImg.forEach(function(i,o){var a='\n                <li>\n                    <a href="#">\n                        <img src="'+i+'" alt="">\n                    </a>\n                </li>\n                ';_(".d_small_area ul").append(a)}),_(".d_small_area ul li:first").addClass("active");var o=i.gName+"<span>"+i.gDes+"</span>";_(".d_inner .d_main_title").html(o),_(".d_inner .d_price_panel p span").text(i.gPrice),i.gColor.forEach(function(i,o){var a="\n            <li>\n                <span>"+i+"<i></i></span>\n            </li>\n            ";_(".d_goodsinfo_color .d_goodsinfo_details ul").append(a)}),_(".d_goodsinfo_color .d_goodsinfo_details ul li:first").addClass("current"),i.gMemory.forEach(function(i,o){var a="\n            <li>\n                <span>"+i+"<i></i></span>\n            </li>\n            ";_(".d_goodsinfo_big .d_goodsinfo_details ul").append(a)}),_(".d_goodsinfo_big .d_goodsinfo_details ul li:first").addClass("current"),i.gBuy.forEach(function(i,o){var a="\n            <li>\n                <span>"+i+"<i></i></span>\n            </li>\n            ";_(".d_goodsinfo_buystyle .d_goodsinfo_details ul").append(a)}),_(".d_goodsinfo_buystyle .d_goodsinfo_details ul li:first").addClass("current"),i.gSuit.forEach(function(i,o){var a="\n            <li>\n                <span>"+i+"<i></i></span>\n            </li>\n            ";_(".d_goodsinfo_suit .d_goodsinfo_details ul").append(a)}),_(".d_goodsinfo_suit .d_goodsinfo_details ul li:first").addClass("current")}),_("#btn_addcart").on("click",function(){var i=sessionStorage.getItem("login"),a=JSON.parse(_(".d_deal_wrap").attr("data-info")),e=parseInt(_("#d_goodsinfo_num").val());console.log(e);var o=_(".d_goodsinfo_color .d_goodsinfo_details li.current").text().trim();a.gColor=o;var n=_(".d_goodsinfo_big .d_goodsinfo_details li.current").text().trim();a.gMemory=n;var t=_(".d_goodsinfo_buystyle .d_goodsinfo_details li.current").text().trim();a.gBuy=t;var s=_(".d_goodsinfo_suit .d_goodsinfo_details li.current").text().trim();a.gSuit=s;var d=JSON.parse(sessionStorage.getItem("login")||"{}");if(a.uId=d.uid,null!=i)a.gNum=e,console.log("登录了"),_.ajax({url:"./../server/cart.php",type:"post",dataType:"json",data:a}).then(function(i){console.log(i.msg),g.getNum(),alert("加入购物车成功！")});else{console.log("没有登录"),a.smallImg="",a.middleImg="",a.bigImg="";var r=JSON.parse(_.cookie("cartInfo")||"[]"),l=!1;r.forEach(function(i,o){i.gId==a.gId&&i.gColor==a.gColor&&i.gMemory==a.gMemory&&i.gBuy==a.gBuy&&i.gSuit==a.gSuit&&(i.gNum=parseInt(i.gNum)+e,l=!0)}),l||(a.gNum=e,r.push(a)),console.log(r),_.cookie("cartInfo",JSON.stringify(r),{expires:7}),g.getNum(),alert("加入购物车成功！")}return!1})})});